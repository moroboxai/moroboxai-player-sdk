<html>
    <head>
        <title>MoroboxAIPlayerSDK Sample</title>
    </head>

    <body class="vertical">
        <div class="horizontal">
            <div id="player"></div>
        </div>
        <div class="info horizontal">
            <button id="attach"></button>
        </div>
        <div class="info">
            <div>
                moroboxai-game-sdk v<span
                    id="moroboxai-game-sdk-version"
                ></span>
            </div>
        </div>
    </body>
    <script type="module">
        import * as MoroboxAIPlayerSDK from "./src/index.ts";
        import { FetchFileServer } from "./src/server.ts";

        document.getElementById("moroboxai-game-sdk-version").innerText =
            MoroboxAIPlayerSDK.GAME_SDK_VERSION;

        let player = null;
        const attachButton = document.getElementById("attach");

        function attach() {
            if (player === null) {
                // Attach player to the DOM
                player = MoroboxAIPlayerSDK.init(
                    // Gutter for making the player work
                    {
                        inputController: () => {},
                        fileServer: (baseUrl) => new FetchFileServer(baseUrl),
                        zipServer: (zipUrl) => {}
                    },
                    // Root element of the player
                    document.getElementById("player"),
                    // Options for the player
                    {
                        url: "https://raw.githubusercontent.com/moroboxai/create-moroboxai-game/master/examples/canvas2d-rgb/header-js.yml",
                        resizable: true,
                        autoPlay: true,
                        scale: 1,
                        agents: [
                            {
                                url: "https://raw.githubusercontent.com/moroboxai/create-moroboxai-game/master/examples/canvas2d-rgb/agent.js"
                            }
                        ],
                        onReady: () => console.log("ready")
                    }
                );

                attachButton.textContent = "Detach Player";
            } else {
                // Remove player from DOM
                player.remove();
                player = null;
                attachButton.textContent = "Attach Player";
            }
        }

        attachButton.onclick = () => attach();
        attach();
    </script>

    <style>
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        .vertical {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .horizontal {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
        }

        #player {
            background-color: black;
            background-size: cover;
        }

        .info {
            margin-top: 2em;
            text-align: center;
        }
    </style>
</html>
